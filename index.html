<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">

        <title>HTML5 Canvas Testing</title>
        <meta name="description" content="A basic HTML5 Canvas Test">
        <meta name="author" content="Matthew J Pruett">
		
		<script src="scripts/random.js"></script>
		<script src="scripts/generics.js"></script>
		<script src="scripts/digital-pet.js"></script>
		<!-- Maybe we will host this ourselves in the future. -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    </head>
    <body>
		<input type="button" value="Feed Pet" onclick="feedPet();"/>
		<input type="button" value="Starve Pet" onclick="starvePet();"/>
		<div id="pet-stats" style="width:100%"></div>
		<div id="pet-output" style="width:100%"></div>
		<div style="margin: auto;">
			<canvas id="canvas" width="750" height="400" style="border:1px solid lightgrey;">
				Your browser does not support the HTML5 canvas tag.
			</canvas>
		</div>
		<a href="other\thanks.html">Special Thanks</a>
        <script>
			// TODO: Move most of this to a game class.
			"use strict";
			var canvas;
			var context;
			var cat;
			window.onload = init;
			
			function init() {
				// Get a reference to the canvas.
				canvas = document.getElementById('canvas');
				context = canvas.getContext('2d');

				draw();
				
				cat = new Pet($("#pet-output"));
				cat.name = "Link";
				cat.type = "Cat";
				refreshPetStats();
			}
			
			function draw() {

				// Get a random color, red or blue.
				let randomColor = Math.random() > 0.5 ? '#ff8080' : '#0099b0';

				// Draw a rectangle.
				context.fillStyle = randomColor;
				context.fillRect(100, 50, 200, 175);
			}

			function feedPet() {
				cat.feed();
				refreshPetStats();
			}

			function starvePet() {
				cat.hunger.inc();
				refreshPetStats();
			}

			function refreshPetStats() {
				$("#pet-stats").html(cat.toHtml());
			}

			// Every second.
			const timerTickMS = 1000;
			var timer = setInterval(gameTimerTicked, timerTickMS);
			var totalTicks = 0;
			function gameTimerTicked() {
				// Every 10 ticks - or 10 seconds - we are going to have the pet do its thing.
				const petTimerTickInterval = 10;

				// If this is the 10th time, call the pets tick event.
				if ((totalTicks % petTimerTickInterval) === 0) {
					cat.timerTicked();
					// Then redraw the pet and stats.
					refreshPetStats();
				}
				totalTicks++;
			}
        </script>
    </body>
</html>